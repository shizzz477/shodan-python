{"body": "<div class=\"section\" id=\"access-ssl-certificates-in-real-time\">\n<h1>Access SSL certificates in Real-Time<a class=\"headerlink\" href=\"#access-ssl-certificates-in-real-time\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p>The new Shodan Streaming API provides real-time access to the information that Shodan is gathering at the moment.\nUsing the Streaming API, you get the raw access to potentially all the data that ends up in the Shodan search engine.\nNote that you can\u2019t search with the Streaming API or perform any other operations that you\u2019re accustomed to with\nthe REST API. This is meant for large-scale consumption of real-time data.</p>\n<p>This script only works with people that have a subscription API plan!\nAnd by default the Streaming API only returns 1% of the data that Shodan gathers.\nIf you wish to have more access please contact us at <a class=\"reference external\" href=\"mailto:support&#37;&#52;&#48;shodan&#46;io\">support<span>&#64;</span>shodan<span>&#46;</span>io</a> for pricing\ninformation.</p>\n<div class=\"highlight-python\"><div class=\"highlight\"><pre><span></span><span class=\"ch\">#!/usr/bin/env python</span>\n<span class=\"c1\">#</span>\n<span class=\"c1\"># cert-stream.py</span>\n<span class=\"c1\"># Stream the SSL certificates that Shodan is collecting at the moment</span>\n<span class=\"c1\">#</span>\n<span class=\"c1\"># WARNING: This script only works with people that have a subscription API plan!</span>\n<span class=\"c1\"># And by default the Streaming API only returns 1% of the data that Shodan gathers.</span>\n<span class=\"c1\"># If you wish to have more access please contact us at sales@shodan.io for pricing</span>\n<span class=\"c1\"># information.</span>\n<span class=\"c1\">#</span>\n<span class=\"c1\"># Author: achillean</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">shodan</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n\n<span class=\"c1\"># Configuration</span>\n<span class=\"n\">API_KEY</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;YOUR API KEY&#39;</span>\n\n<span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"c1\"># Setup the api</span>\n    <span class=\"n\">api</span> <span class=\"o\">=</span> <span class=\"n\">shodan</span><span class=\"o\">.</span><span class=\"n\">Shodan</span><span class=\"p\">(</span><span class=\"n\">API_KEY</span><span class=\"p\">)</span>\n\n    <span class=\"k\">print</span> <span class=\"s1\">&#39;Listening for certs...&#39;</span>\n    <span class=\"k\">for</span> <span class=\"n\">banner</span> <span class=\"ow\">in</span> <span class=\"n\">api</span><span class=\"o\">.</span><span class=\"n\">stream</span><span class=\"o\">.</span><span class=\"n\">ports</span><span class=\"p\">([</span><span class=\"mi\">443</span><span class=\"p\">,</span> <span class=\"mi\">8443</span><span class=\"p\">]):</span>\n                <span class=\"k\">if</span> <span class=\"s1\">&#39;ssl&#39;</span> <span class=\"ow\">in</span> <span class=\"n\">banner</span><span class=\"p\">:</span>\n                        <span class=\"c1\"># Print out all the SSL information that Shodan has collected</span>\n                        <span class=\"k\">print</span> <span class=\"n\">banner</span><span class=\"p\">[</span><span class=\"s1\">&#39;ssl&#39;</span><span class=\"p\">]</span>\n\n<span class=\"k\">except</span> <span class=\"ne\">Exception</span> <span class=\"k\">as</span> <span class=\"n\">e</span><span class=\"p\">:</span>\n    <span class=\"k\">print</span> <span class=\"s1\">&#39;Error: </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">e</span>\n    <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exit</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</div>\n", "alabaster_version": "0.7.10", "display_toc": false, "title": "Access SSL certificates in Real-Time", "sourcename": "examples/cert-stream.rst.txt", "customsidebar": null, "metatags": "", "current_page_name": "examples/cert-stream", "next": {"link": "../gifcreator/", "title": "GIF Creator"}, "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["examples/gifcreator", "GIF Creator", "N", "next"], ["examples/query-summary", "Collecting Summary Information using Facets", "P", "previous"]], "meta": {}, "parents": [], "sidebars": null, "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Access SSL certificates in Real-Time</a></li>\n</ul>\n", "prev": {"link": "../query-summary/", "title": "Collecting Summary Information using Facets"}, "page_source_suffix": ".rst"}